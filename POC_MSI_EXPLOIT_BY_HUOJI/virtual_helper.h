#pragma once
#include "head.h"
#include "native_struct.h"
class virtual_helper
{
public:
	uint64_t m_PebBase;
	uint64_t m_PebEnd;
	uint64_t m_TebBase;
	uint64_t m_TebEnd;
	uint64_t m_gs_base = 0x7efdd000;

	PVOID stack_buf;
	uint64_t m_stack_base;
	uint64_t m_stack_end;
	uint64_t m_heap_base;
	uint64_t m_heap_end;
	uint64_t fake_base;
	std::vector<struct_moudle> moudle_list;
	void init_virtual_pte();
	void init_virtual_processer();
	void map_special_moudle(char* params_moudle_name);
	void init_virtual_helper();
};
