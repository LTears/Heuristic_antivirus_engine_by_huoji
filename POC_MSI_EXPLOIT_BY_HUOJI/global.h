#pragma once
#include "head.h"
#include "pe_action.h"
class globalvar
{
public:
	csh hanlde_capstone;
	uc_engine* uc_engine;
	uc_hook hook_code;
	uc_hook hook_mem;
	uc_hook hook_mem_unmap;
	uc_hook hook_mem_write;
	uc_hook hook_sys_call;
	std::vector<sim_process> process; //虚拟的进程列表
	std::unordered_map<uint64_t, std::string> syscall_tables;
};

extern globalvar* g_global;
extern pe_action* g_pe;
extern virtual_helper* g_virtual;
extern ssdt_manager* g_ssdt;